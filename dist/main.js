(()=>{"use strict";const e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};class t{constructor(e,t,s){this._title=e.title,this._image=e.image,this._templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".cards__item").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._elementChangeData(),this._element}_elementChangeData(){this._element.querySelector(".cards__image").src=this._image,this._element.querySelector(".cards__title").textContent=this._title,this._element.querySelector(".cards__image").alt=this._title}_setEventListeners(){this._element.querySelector(".cards__like-btn").addEventListener("click",(e=>{this._handleLikeButton(e)})),this._element.querySelector(".cards__remove-btn").addEventListener("click",(e=>{this._handleDeleteCard(e)})),this._element.querySelector(".cards__image").addEventListener("click",(()=>{this._handleCardClick(this._title,this._image)}))}_handleLikeButton(e){e.target.classList.toggle("cards__like-btn_active")}_handleDeleteCard(e){this._element.remove(e)}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent="",e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._submitButton)}))}))}enableValidation(){this._setEventListeners()}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.disabled=!0):(t.classList.remove(this._inactiveButtonClass),t.disabled=!1)}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}}class n{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_is-opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_is-opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-btn").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("popup_is-opened")&&this.close()}))}}class r extends n{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupElement.querySelector(".popup__form"),this._inputList=this._popupElement.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".popup_type_profile"),i=(o.querySelector(".popup__close-btn"),document.querySelector(".profile__edit-button")),l=document.querySelector(".popup__form"),p=l.querySelector('input[name="name"]'),a=l.querySelector('input[name="job"]'),c=(document.querySelector(".profile__title"),document.querySelector(".profile__profession"),document.querySelector(".popup_type_add-place")),u=(c.querySelector(".popup__close-btn"),document.querySelector(".profile__add-button")),_=(c.querySelector(".popup__form"),document.querySelector(".popup__input_type_place-name")),d=document.querySelector(".popup__input_type_link"),m=(document.querySelector(".popup__button_invalid"),document.querySelector(".popup_type_place-image")),h=(m.querySelector(".popup__image"),m.querySelector(".popup__close-btn"),m.querySelector(".popup__image-title"),document.querySelector(".cards"),new class{constructor({nameSelector:e,infoSelector:t}){this._nameElement=document.querySelector(e),this._infoElement=document.querySelector(t)}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.info=this._infoElement.textContent,e}setUserInfo({name:e,job:t}){this._nameElement.textContent=e,this._infoElement.textContent=t}}({nameSelector:".profile__title",infoSelector:".profile__profession"})),y=new r(".popup_type_profile",(function(e){h.setUserInfo(e),y.close()}));y.setEventListeners();const E=new r(".popup_type_add-place",(()=>{const e=S({title:_.value,image:d.value});v.addItem(e),E.close()}));function S(e){return new t(e,"#templateCards",f).generateCard()}E.setEventListeners();const v=new class{constructor({renderer:e},t){this._renderer=e,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=S(e);v.addItem(t)}},".cards");v.renderItems([{title:"Архыз",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}]);const g=new class extends n{constructor(e){super(e),this._popupImageElementImage=this._popupElement.querySelector(".popup__image"),this._popupTitleElementImage=this._popupElement.querySelector(".popup__image-title")}open(e,t){this._popupImageElementImage.src=t,this._popupImageElementImage.alt=e,this._popupTitleElementImage.textContent=e,super.open()}}(".popup_type_place-image");function f(e,t){g.open(e,t)}g.setEventListeners(),new s(e,o).enableValidation(),i.addEventListener("click",(function(){const e=h.getUserInfo();p.value=e.name,a.value=e.info,y.open()})),u.addEventListener("click",(function(){E.open(),q.disableSubmitButton()}));const q=new s(e,c);q.enableValidation()})();